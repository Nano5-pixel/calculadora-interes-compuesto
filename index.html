<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de inter√©s compuesto</title>
    
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/2344/2344132.png" type="image/png">

    <script defer src="/_vercel/insights/script.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Orbitron:wght@900&display=swap');
        :root { --neon: #00ffcc; --blue: #0099ff; --pink: #ff00ff; --orange: #ff9900; --bg: #0f172a; --card: #1e293b; --red: #ff4444; --yellow: #ffcc00; --green: #00ff88; }
        
        body { background-color: var(--bg); color: #f8fafc; font-family: 'JetBrains Mono', monospace; display: flex; flex-direction: column; align-items: center; padding: 10px; min-height: 100vh; margin: 0; }
        .container { background-color: var(--card); padding: 25px; border-radius: 20px; box-shadow: 0 0 50px rgba(0, 255, 204, 0.15); border: 1px solid #334155; max-width: 1200px; width: 100%; box-sizing: border-box; }
        
        h1 { font-family: 'Orbitron', sans-serif; color: var(--neon); text-align: center; text-transform: uppercase; margin-bottom: 5px; font-size: 1.5rem; text-shadow: 0 0 15px rgba(0, 255, 204, 0.5); }
        .subtitle { text-align: center; color: var(--blue); text-transform: uppercase; letter-spacing: 4px; font-size: 0.7rem; font-weight: 700; margin-bottom: 30px; }
        
        @media (min-width: 768px) { h1 { font-size: 2.5rem; } .subtitle { font-size: 0.9rem; letter-spacing: 10px; } }

        .mode-selector select { width: 100%; padding: 15px; background: #161e2d; color: var(--neon); border: 2px solid var(--neon); border-radius: 12px; font-weight: bold; cursor: pointer; font-size: 1rem; margin-bottom: 25px; font-family: inherit; }
        
        .grid-inputs { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 15px; margin-bottom: 25px; }
        label { font-size: 0.65rem; color: #94a3b8; text-transform: uppercase; font-weight: bold; display: block; margin-bottom: 6px; }
        input, select { width: 100%; padding: 12px; background: #0f172a; border: 1px solid #334155; color: white; border-radius: 10px; font-family: inherit; box-sizing: border-box; font-size: 0.9rem; }

        .tax-toggle { display: flex; align-items: center; background: rgba(255, 153, 0, 0.1); padding: 15px; border-radius: 12px; border: 1px solid var(--orange); grid-column: 1 / -1; cursor: pointer; transition: 0.3s; }
        .tax-toggle:hover { background: rgba(255, 153, 0, 0.2); }
        .tax-toggle input { width: auto; margin-right: 15px; accent-color: var(--orange); }
        .tax-toggle label { cursor: pointer; color: var(--orange); font-weight: bold; font-size: 0.8rem; display: flex; align-items: center; gap: 8px; }

        .btn-group { display: flex; flex-direction: column; gap: 12px; margin-top: 10px; }
        button { width: 100%; padding: 18px; border-radius: 12px; cursor: pointer; text-transform: uppercase; letter-spacing: 2px; font-weight: 900; transition: 0.3s; font-family: inherit; }
        .btn-main { background: linear-gradient(135deg, var(--neon), var(--blue)); border: none; color: #0f172a; box-shadow: 0 4px 15px rgba(0, 255, 204, 0.3); }
        .btn-main:hover { transform: scale(1.02); filter: brightness(1.1); }
        .btn-reset { background: transparent; border: 1px solid #334155; color: #94a3b8; font-size: 0.75rem; }
        .btn-reset:hover { border-color: var(--pink); color: var(--pink); background: rgba(255, 0, 255, 0.05); }

        .main-layout { display: flex; flex-direction: column; gap: 25px; margin-top: 35px; }
        @media (min-width: 1024px) { .main-layout { display: grid; grid-template-columns: 380px 1fr; } }

        .result-box { padding: 20px; background: #0b1120; border-radius: 15px; border-left: 6px solid var(--neon); margin-bottom: 15px; transition: 0.3s; }
        .result-box:hover { transform: translateX(5px); }
        .res-label { font-size: 0.7rem; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; }
        .res-val { font-size: 1.6rem; color: var(--neon); font-weight: bold; margin-top: 8px; display: block; word-break: break-all; }
        
        .chart-container { background: #0b1120; padding: 15px; border-radius: 20px; height: 350px; border: 1px solid #334155; position: relative; }
        @media (min-width: 768px) { .chart-container { height: 500px; padding: 25px; } }

        .table-wrapper { overflow-x: auto; border: 1px solid #334155; border-radius: 15px; margin-top: 20px; background: #0b1120; max-height: 400px; }
        table { width: 100%; border-collapse: collapse; font-size: 0.75rem; min-width: 450px; }
        th { background: #1e293b; color: var(--neon); padding: 15px; text-transform: uppercase; position: sticky; top: 0; }
        td { padding: 12px; border-bottom: 1px solid #334155; text-align: center; }

        /* GU√çA DEL INVERSOR MEJORADA */
        .user-guide { margin-top: 40px; padding: 30px; background: #161e2d; border-radius: 20px; border: 1px dashed #334155; }
        .guide-h { color: var(--neon); font-family: 'Orbitron', sans-serif; font-size: 1.1rem; margin-bottom: 25px; text-transform: uppercase; border-bottom: 1px solid #334155; padding-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .guide-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; }
        .guide-section { background: rgba(15, 23, 42, 0.4); padding: 20px; border-radius: 12px; border: 1px solid #1e293b; }
        .guide-section h4 { color: var(--blue); margin: 0 0 12px 0; font-size: 0.9rem; text-transform: uppercase; }
        .guide-section p, .guide-section li { font-size: 0.8rem; color: #94a3b8; line-height: 1.6; margin: 0; }
        .guide-section ul { padding-left: 18px; margin-top: 10px; }
        .guide-section li { margin-bottom: 8px; }
        .guide-section li b { color: var(--neon); }
        .risk-dot { display: inline-block; width: 10px; height: 10px; border-radius: 50%; margin-right: 8px; }

        .credits { margin-top: 40px; text-align: center; font-size: 0.75rem; color: #475569; letter-spacing: 5px; text-transform: uppercase; }
    </style>
</head>
<body>

    <div class="container">
        <h1>Calculadora de inter√©s compuesto</h1>
        <p class="subtitle">Nano Edition</p>

        <div class="mode-selector">
            <select id="modo" onchange="cambiarModo()">
                <option value="ahorro">¬øCu√°nto dinero tendr√© en X a√±os?</option>
                <option value="tiempo">¬øCu√°nto tardar√© en alcanzar mi objetivo?</option>
                <option value="cuota">¬øCu√°nto necesito ahorrar cada mes?</option>
                <option value="interes">¬øQu√© inter√©s necesito para mi objetivo?</option>
            </select>
        </div>
        
        <div class="grid-inputs">
            <div id="div-objetivo" style="display:none;"><label>Objetivo (‚Ç¨)</label><input type="number" id="objetivo" value="100000" min="0"></div>
            <div id="div-capital"><label>Cap. Inicial (‚Ç¨)</label><input type="number" id="capital" value="5000" min="0"></div>
            <div id="div-aporte"><label>Aporte Mensual (‚Ç¨)</label><input type="number" id="aporte" value="500" min="0"></div>
            <div id="div-interes"><label>Inter√©s Anual (%)</label><input type="number" id="interes" value="10" min="0" step="0.1"></div>
            <div id="div-anios"><label>A√±os de Inversi√≥n</label><input type="number" id="anios" value="20" min="1" step="1"></div>
            <div id="div-inflacion"><label>Inflaci√≥n Estimada (%)</label><input type="number" id="inflacion" value="2" min="0" step="0.1"></div>
            <div id="div-momento">
                <label>Frecuencia de Dep√≥sito</label>
                <select id="momento">
                    <option value="fin">Al final del mes</option>
                    <option value="inicio">Al inicio del mes</option>
                </select>
            </div>
            <div class="tax-toggle">
                <input type="checkbox" id="tax-on" checked>
                <label for="tax-on">
                    <span style="font-family: Arial, sans-serif; font-size: 1.2rem;">üá™üá∏</span> APLICAR IRPF ESPA√ëA (Ahorro)
                </label>
            </div>
        </div>

        <div class="btn-group">
            <button class="btn-main" onclick="ejecutarCalculo()">Analizar Plan Financiero</button>
            <button class="btn-reset" onclick="reiniciarDatos()">üóëÔ∏è Limpiar Todos los Datos</button>
        </div>

        <div class="main-layout">
            <div class="data-side">
                <div class="result-box">
                    <span class="res-label">CAPITAL BRUTO FINAL:</span>
                    <span class="res-val" id="res-nom">0,00 ‚Ç¨</span>
                </div>
                <div class="result-box" style="border-color: var(--pink); background: rgba(255, 0, 255, 0.03);">
                    <span class="res-label" style="color: var(--pink);">PODER DE COMPRA REAL (NETO):</span>
                    <span class="res-val" id="res-real" style="color: var(--pink);">0,00 ‚Ç¨</span>
                </div>
                <div class="table-wrapper">
                    <table>
                        <thead><tr><th>A√±o</th><th>Invertido</th><th>Balance</th><th>Real (Neto)</th></tr></thead>
                        <tbody id="cuerpo-tabla"></tbody>
                    </table>
                </div>
            </div>
            <div class="chart-side">
                <div class="chart-container"><canvas id="miGrafico"></canvas></div>
            </div>
        </div>

        <div class="user-guide">
            <div class="guide-h">üìñ Gu√≠a del Inversor Profesional</div>
            <div class="guide-grid">
                <div class="guide-section">
                    <h4>üìä C√≥mo usar esta herramienta</h4>
                    <p>Selecciona tu objetivo arriba. La calculadora ajustar√° los campos autom√°ticamente:</p>
                    <ul>
                        <li><b>Ahorro:</b> Proyecta tu riqueza final.</li>
                        <li><b>Tiempo:</b> Calcula los a√±os necesarios para jubilarte.</li>
                        <li><b>Cuota:</b> Descubre cu√°nto ahorrar al mes para tu meta.</li>
                        <li><b>Inter√©s:</b> Halla la rentabilidad m√≠nima que necesitas.</li>
                    </ul>
                </div>
                <div class="guide-section">
                    <h4>‚öñÔ∏è Hacienda e Inflaci√≥n</h4>
                    <p>Un error com√∫n es ignorar que el dinero pierde valor. Aqu√≠ aplicamos:</p>
                    <ul>
                        <li><b>IRPF Espa√±a:</b> Tramos oficiales (19%, 21%, 23%, 27%, 28%) sobre el beneficio generado.</li>
                        <li><b>Inflaci√≥n:</b> Ajustamos el capital final al poder de compra de hoy (valor real).</li>
                    </ul>
                </div>
                <div class="guide-section">
                    <h4>üö• Sem√°foro de Riesgo Anual</h4>
                    <p>Eval√∫a si tu rentabilidad esperada es realista seg√∫n el mercado actual:</p>
                    <ul>
                        <li><span class="risk-dot" style="background:var(--green)"></span><b>Bajo (&lt;5%):</b> Perfil conservador (Letras, Dep√≥sitos).</li>
                        <li><span class="risk-dot" style="background:var(--yellow)"></span><b>Medio (5-9%):</b> Perfil moderado (√çndices como S&P 500).</li>
                        <li><span class="risk-dot" style="background:var(--red)"></span><b>Alto (&gt;9%):</b> Perfil agresivo (Acciones individuales, Cripto).</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="credits">Desarrollado por <b>Nano</b> | 2026 Edition</div>
    </div>

    <script>
        let grafico;
        
        function cambiarModo() {
            const m = document.getElementById('modo').value;
            const ids = ['div-objetivo', 'div-capital', 'div-aporte', 'div-interes', 'div-anios'];
            const configuracion = {
                'ahorro': ['div-capital', 'div-aporte', 'div-interes', 'div-anios'],
                'tiempo': ['div-objetivo', 'div-capital', 'div-aporte', 'div-interes'],
                'cuota': ['div-objetivo', 'div-capital', 'div-interes', 'div-anios'],
                'interes': ['div-objetivo', 'div-capital', 'div-aporte', 'div-anios']
            };
            
            ids.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.style.display = configuracion[m].includes(id) ? 'block' : 'none';
            });
        }

        function reiniciarDatos() {
            document.getElementById('capital').value = 0;
            document.getElementById('aporte').value = 0;
            document.getElementById('interes').value = 0;
            document.getElementById('anios').value = 1;
            document.getElementById('objetivo').value = 0;
            ejecutarCalculo();
        }

        function calcularIRPF(beneficio) {
            if (beneficio <= 0) return 0;
            if (beneficio <= 6000) return beneficio * 0.19;
            if (beneficio <= 50000) return (6000 * 0.19) + (beneficio - 6000) * 0.21;
            if (beneficio <= 200000) return (6000 * 0.19) + (44000 * 0.21) + (beneficio - 50000) * 0.23;
            if (beneficio <= 300000) return (6000 * 0.19) + (44000 * 0.21) + (150000 * 0.23) + (beneficio - 200000) * 0.27;
            return (6000 * 0.19) + (44000 * 0.21) + (150000 * 0.23) + (100000 * 0.27) + (beneficio - 300000) * 0.28;
        }

        function fv(P, PMT, r, n, momento) {
            if (r === 0) return P + (PMT * n);
            const comp = Math.pow(1 + r, n);
            return (momento === 'inicio') ? P * comp + PMT * (1 + r) * (comp - 1) / r : P * comp + PMT * (comp - 1) / r;
        }

        function ejecutarCalculo() {
            const modo = document.getElementById('modo').value, useTax = document.getElementById('tax-on').checked;
            const cap = parseFloat(document.getElementById('capital').value) || 0, obj = parseFloat(document.getElementById('objetivo').value) || 0;
            const infla = parseFloat(document.getElementById('inflacion').value) / 100, mom = document.getElementById('momento').value;
            let ap = parseFloat(document.getElementById('aporte').value) || 0, intA = parseFloat(document.getElementById('interes').value) / 100 || 0, anMax = parseInt(document.getElementById('anios').value) || 1;

            if (modo === 'interes') {
                let low = 0, high = 10; for(let i=0; i<50; i++){ let mid = (low + high) / 2; if (fv(cap, ap, mid/12, anMax*12, mom) < obj) low = mid; else high = mid; }
                intA = high; document.getElementById('res-nom').innerText = (intA * 100).toFixed(2) + " %";
            } else if (modo === 'cuota') {
                const n = anMax * 12, r = intA / 12, factor = Math.pow(1 + r, n);
                const den = (mom === 'inicio') ? ((factor - 1) / r) * (1 + r) : (factor - 1) / r;
                ap = (obj - (cap * factor)) / den; document.getElementById('res-nom').innerText = Math.max(0, ap).toLocaleString('es-ES', {style: 'currency', currency: 'EUR'});
            }

            let bal = cap, tAp = cap, labels = [], dN = [], dR = [], dI = [];
            const tb = document.getElementById('cuerpo-tabla'); tb.innerHTML = "";
            const mesesTotales = Math.min(1200, (modo === 'tiempo' ? 1200 : anMax*12));

            for(let m=1; m <= mesesTotales; m++) {
                bal = (mom === 'inicio') ? (bal + ap) * (1 + intA/12) : (bal * (1 + intA/12)) + ap;
                tAp += ap; 
                if (m % 12 === 0 || m === mesesTotales) {
                    let a = m/12, bNeto = bal - (useTax ? calcularIRPF(bal - tAp) : 0);
                    let bReal = bNeto / Math.pow(1 + infla, a);
                    labels.push("A"+Math.round(a)); dN.push(bNeto.toFixed(2)); dR.push(bReal.toFixed(2)); dI.push(tAp.toFixed(2));
                    tb.innerHTML += `<tr><td>${Math.round(a)}</td><td>${Math.round(tAp).toLocaleString()}‚Ç¨</td><td>${Math.round(bNeto).toLocaleString()}‚Ç¨</td><td style="color:var(--pink); font-weight:bold;">${Math.round(bReal).toLocaleString()}‚Ç¨</td></tr>`;
                    if (modo === 'tiempo' && bNeto >= obj) { document.getElementById('res-nom').innerText = a.toFixed(1) + " a√±os"; break; }
                }
            }
            if (modo === 'ahorro') document.getElementById('res-nom').innerText = (bal).toLocaleString('es-ES', {style: 'currency', currency: 'EUR'});
            document.getElementById('res-real').innerText = (dN[dN.length-1] / Math.pow(1 + infla, dN.length)).toLocaleString('es-ES', {style: 'currency', currency: 'EUR'});
            actualizarGrafico(labels, dN, dR, dI);
        }

        function actualizarGrafico(l, n, r, i) {
            const ctx = document.getElementById('miGrafico').getContext('2d');
            if (grafico) grafico.destroy();
            grafico = new Chart(ctx, {
                type: 'line',
                data: { labels: l, datasets: [
                    { label: 'Neto', data: n, borderColor: '#00ffcc', backgroundColor: 'rgba(0, 255, 204, 0.1)', fill: true, tension: 0.3 },
                    { label: 'Real', data: r, borderColor: '#ff00ff', borderDash: [5, 5], fill: false, tension: 0.3 },
                    { label: 'Capital', data: i, borderColor: '#0099ff', borderDash: [2, 2], fill: false, tension: 0.3 }
                ]},
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { grid: { color: '#334155' }, ticks: { color: '#94a3b8' } }, x: { grid: { display: false }, ticks: { color: '#94a3b8' } } } }
            });
        }
        
        cambiarModo();
        ejecutarCalculo();
    </script>
</body>
</html>
